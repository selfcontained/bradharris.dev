<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="theme-color" content="#0C171C">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="icon" type="image/png" href="/favicon-32x32.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
  <link href="https://fonts.googleapis.com/css2?family=Playball&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/default.min.css">
  <link rel="stylesheet" href="/styles/monokai.css">

  <title>Javascript getFirstDescendantBy()</title>
  <meta content="Hello, I'm Brad Harris. I help build products with software, and love the web ❤️. I live in Castle Rock, Colorado and stay busy enjoying life with my family." name="description">

  
  <meta property="og:url" content="https://bradharris.dev/old-school/2008-08-20/javascript-getfirstdescendantby/">
  <meta property="og:title" content="Javascript getFirstDescendantBy()">
  
    <meta property="og:image" content="https://bradharris.dev/post-thumbnails/brad.jpg">
  
  
  
    <meta property="og:description" content="Hello, I'm Brad Harris. I help build products with software, and love the web ❤️. I live in Castle Rock, Colorado and stay busy enjoying life with my family.">
  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@selfc0ntained">
  <meta name="twitter:creator" content="@selfc0ntained">
  <meta name="twitter:title" content="Javascript getFirstDescendantBy()">
  
  
    <meta name="twitter:description" content="Hello, I'm Brad Harris. I help build products with software, and love the web ❤️. I live in Castle Rock, Colorado and stay busy enjoying life with my family.">
  
  
    <meta name="twitter:image" content="https://bradharris.dev/post-thumbnails/brad.jpg">
  
  
    <meta name="twitter:image:alt" content="Picture of Brad Harris">
  

  <script>
    (() => {
      // prevent flashing of light=>dark mode on load
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches
      const darkEnabled = localStorage.getItem('dark-mode')
      if(darkEnabled === "true" || (prefersDark && darkEnabled !== "false")) {
        document.documentElement.classList.toggle("dark-mode", true);
      }
    })();
  </script>
</head>
<body>
  <div id="main-layout">
    <header>
      <nav>
        <ul>
          <li><a href="/">bradharris.dev</a></li>
          <li><a href="/about/">about</a></li>
          <li><a href="/posts/">posts</a></li>
        </ul>
      </nav>
      <dark-mode-toggle key="dark-mode" darkmode-class="dark-mode">
    </dark-mode-toggle></header>


    <main class="post">
      
<h1>Javascript getFirstDescendantBy()</h1>
<time>August 20th, 2008</time>

<article><hr>
<blockquote>
<p>Update: <a href="/2009/01/22/followup-on-yui-getfirstdescendantby/">A new native YUI function is in the works, and does this job better</a></p>
</blockquote>
<hr>
<p>Recently I was working on optimizing some javascript, and found a slow area that was trying to find the first focusable input in a certain area of the page, and it was taking anywhere from 100 - 500 milliseconds, depending on the size of the DOM tree in that element.  After digging into it, I noticed it was using the <code>YAHOO.util.dom.getElementsBy()</code> method, which basically had to walk through the whole DOM tree in this case, testing each node against the boolean method passed in.  After calling that, it would then return the first, if any, element that getElementsBy returned.  Obviously this was a bad approach, as after you find the first match, there is no need to go further.</p>
<p>I did a little research, and saw that this had come up in <a href="http://tech.groups.yahoo.com/group/ydn-javascript/message/19684">a thread on the YUI group</a>.  I ended up writing a small method to fill in this functionality I wanted out of YUI, called <code>getFirstDescendantBy(rootEl, method)</code>.  The function takes a root element, or string id of that element, and then a function to test each element against that has the element being tested as the only input.  This function passed in should return a boolean, and is similar to the way the YUI dom function <code>getElementsBy()</code> works.  Hopefully this will help out some people in similar situations.</p>
<pre><code class="language-javascript hljs"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getFirstDescendantBy</span>(<span class="hljs-params">rootEl, method</span>) {
	<span class="hljs-keyword">var</span> root = <span class="hljs-keyword">typeof</span> rootEl === <span class="hljs-string">'string'</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(rootEl) : rootEl;
	<span class="hljs-keyword">var</span> firstDescendant = <span class="hljs-literal">null</span>;
	<span class="hljs-keyword">var</span> children = root.<span class="hljs-property">childNodes</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> idx <span class="hljs-keyword">in</span> children) {
		<span class="hljs-keyword">var</span> child = children[idx];
		<span class="hljs-keyword">if</span>(child.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>) {
			<span class="hljs-keyword">if</span>(<span class="hljs-title function_">method</span>(child)) {
				firstDescendant = child;
				<span class="hljs-keyword">break</span>;
			}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(child.<span class="hljs-property">childNodes</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
				<span class="hljs-keyword">var</span> recursiveResult = <span class="hljs-title function_">getFirstDescendantBy</span>(child, method);
				<span class="hljs-keyword">if</span>(recursiveResult !== <span class="hljs-literal">null</span>) {
					firstDescendant = recursiveResult;
					<span class="hljs-keyword">break</span>;
				}
			}
		}
	}
	<span class="hljs-keyword">return</span> firstDescendant;
}
</code></pre>
</article>
    </main>
    <footer>
      <span>© 2023 Brad Harris</span>
      <a href="https://twitter.com/selfc0ntained" rel="me"><img src="/icons/twitter.png" width="15" class="glow-2"></a>
      <a href="https://github.com/selfcontained" rel="me"><img src="/icons/github.png" width="15" class="glow"></a>
      <a href="https://www.linkedin.com/in/bradharris/" rel="me"><img src="/icons/linkedin.png" width="15" class="glow-3"></a>
      <dark-mode-toggle key="dark-mode" darkmode-class="dark-mode">
    </dark-mode-toggle></footer>
  </div>
  <script src="/scripts/dark-mode-toggle.js"></script>
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-49NP8W3EPZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-49NP8W3EPZ');
    </script>
  

</body></html>