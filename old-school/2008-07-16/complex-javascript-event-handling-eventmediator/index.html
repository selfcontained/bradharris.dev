<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="theme-color" content="#0C171C">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="icon" type="image/png" href="/favicon-32x32.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
  <link href="https://fonts.googleapis.com/css2?family=Playball&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/default.min.css">
  <link rel="stylesheet" href="/styles/monokai.css">

  <title>Complex Javascript Event Handling: EventMediator</title>
  <meta content="Hello, I'm Brad Harris. I help build products with software, and love the web ❤️. I live in Castle Rock, Colorado and stay busy enjoying life with my family." name="description">

  
  <meta property="og:url" content="https://bradharris.dev/old-school/2008-07-16/complex-javascript-event-handling-eventmediator/">
  <meta property="og:title" content="Complex Javascript Event Handling: EventMediator">
  
    <meta property="og:image" content="https://bradharris.dev/post-thumbnails/brad.jpg">
  
  
  
    <meta property="og:description" content="Hello, I'm Brad Harris. I help build products with software, and love the web ❤️. I live in Castle Rock, Colorado and stay busy enjoying life with my family.">
  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@selfc0ntained">
  <meta name="twitter:creator" content="@selfc0ntained">
  <meta name="twitter:title" content="Complex Javascript Event Handling: EventMediator">
  
  
    <meta name="twitter:description" content="Hello, I'm Brad Harris. I help build products with software, and love the web ❤️. I live in Castle Rock, Colorado and stay busy enjoying life with my family.">
  
  
    <meta name="twitter:image" content="https://bradharris.dev/post-thumbnails/brad.jpg">
  
  
    <meta name="twitter:image:alt" content="Picture of Brad Harris">
  

  <script>
    (() => {
      // prevent flashing of light=>dark mode on load
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches
      const darkEnabled = localStorage.getItem('dark-mode')
      if(darkEnabled === "true" || (prefersDark && darkEnabled !== "false")) {
        document.documentElement.classList.toggle("dark-mode", true);
      }
    })();
  </script>
</head>
<body>
  <div id="main-layout">
    <header>
      <nav>
        <ul>
          <li><a href="/">bradharris.dev</a></li>
          <li><a href="/about/">about</a></li>
          <li><a href="/posts/">posts</a></li>
        </ul>
      </nav>
      <dark-mode-toggle key="dark-mode" darkmode-class="dark-mode">
    </dark-mode-toggle></header>


    <main class="post">
      
<h1>Complex Javascript Event Handling: EventMediator</h1>
<time>July 16th, 2008</time>

<article><p>A large enterprise sized project I work on uses YUI library extensively, and events are a huge part of the rich front end we're developing.  What you start to learn quickly about UI events, is that dependencies between different events start to get very complicated very fast.  When A depends on B, but B needs to wait for C and D and E to finish, but E needs to wait for F to finish, you have a complex situation on your hands.  Up until recently we were able to rely mostly on just using CustomEvents in YUI to handle this for us.</p>
<p>Where that starts to break down is when you have one event, <strong>A</strong>, that is dependent on multiple other events, <strong>B, C, D</strong>.  You now have to manually keep track of what has fired, and make sure you don't fire that <strong>A</strong> until <strong>B, C and D</strong> have all fired.  With very little code, here is a simple class that can be used in conjunction with YIU CustomEvents.  It will handle the 'book-keeping' of firing what you want when all the events you have designated fire.</p>
<pre><code class="language-javascript hljs"><span class="hljs-title class_">EventMediator</span> = {

	addActivationRecord : <span class="hljs-keyword">function</span>(<span class="hljs-params">record</span>) {
		record = record || {};
		<span class="hljs-keyword">var</span> that = <span class="hljs-variable language_">this</span>;
		<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> idx <span class="hljs-keyword">in</span> record.<span class="hljs-property">events</span>) {
			<span class="hljs-keyword">var</span> eventRecord = record.<span class="hljs-property">events</span>[idx];
			<span class="hljs-keyword">if</span>(eventRecord.<span class="hljs-property">event</span> !== <span class="hljs-literal">null</span>) {
				eventRecord.<span class="hljs-property">fired</span> = <span class="hljs-literal">false</span>;
				eventRecord.<span class="hljs-property">event</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">scopedEvent</span>) {
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
						scopedEvent.<span class="hljs-property">fired</span> = <span class="hljs-literal">true</span>;
						that.<span class="hljs-title function_">fireActivation</span>(record);
					}
				}(eventRecord));
			}
		}
	},

	fireActivation : <span class="hljs-keyword">function</span>(<span class="hljs-params">record</span>) {
		<span class="hljs-keyword">var</span> fired = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> idx <span class="hljs-keyword">in</span> record.<span class="hljs-property">events</span>) {
			<span class="hljs-keyword">if</span>(record.<span class="hljs-property">events</span>[idx].<span class="hljs-property">fired</span> === <span class="hljs-literal">false</span>) {
				fired = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">break</span>;
			}
		}
		<span class="hljs-keyword">if</span>(fired === <span class="hljs-literal">true</span>) {
			record.<span class="hljs-property">activate</span>.<span class="hljs-title function_">call</span>(record.<span class="hljs-property">scope</span>);
		}
	}

};
</code></pre>
<p>Using the EventMediator would look something like the following:</p>
<pre><code class="language-javascript hljs"><span class="hljs-title class_">EventMediator</span>.<span class="hljs-title function_">addActivationRecord</span>({
	events : [
		{ event : myObj.<span class="hljs-property">someYUICusomEvent</span> },
		{ event : myObj.<span class="hljs-property">anotherYUICusomEvent</span> }
	],
	activate : myObj1.<span class="hljs-property">myActivationCallback</span>,
	scope : myObj1
});
</code></pre>
<p>It's pretty straightforward I think.  You call <code>addActivationRecord</code>, passing in an array of objects, whose 'event' property points to a YUI CustomEvent.  You also provide an <em>activate</em> callback method, and give it a scope in which to call the method.  For my purposes so far this has worked pretty well, although I'm sure it could be built up to be much more robust.  Hope it helps someone out!</p>
</article>
    </main>
    <footer>
      <span>© 2023 Brad Harris</span>
      <a href="https://twitter.com/selfc0ntained" rel="me"><img src="/icons/twitter.png" width="15" class="glow-2"></a>
      <a href="https://github.com/selfcontained" rel="me"><img src="/icons/github.png" width="15" class="glow"></a>
      <a href="https://www.linkedin.com/in/bradharris/" rel="me"><img src="/icons/linkedin.png" width="15" class="glow-3"></a>
      <dark-mode-toggle key="dark-mode" darkmode-class="dark-mode">
    </dark-mode-toggle></footer>
  </div>
  <script src="/scripts/dark-mode-toggle.js"></script>
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-49NP8W3EPZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-49NP8W3EPZ');
    </script>
  

</body></html>